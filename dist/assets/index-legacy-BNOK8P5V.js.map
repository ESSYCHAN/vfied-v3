{"version":3,"file":"index-legacy-BNOK8P5V.js","sources":["../../src/main.js"],"sourcesContent":["// VFIED Unified Main (Food + Social + Travel + Events) ‚Äî with Toasts, Skeletons, Fallback & Stats\n// API base: prefers window.__API__ if present (Render/Prod), else local dev.\nconst API_BASE = (typeof window !== 'undefined' && window.__API__) || 'https://vfied-v3.onrender.com';\n\n// ---------------- Demo / Fallback Data ----------------\nconst demoFriends = [\n  { name: 'Sarah', comment: 'üî• Best ramen spot ever!', emoji: 'üçú', avatar: 'https://i.pravatar.cc/80?img=32' },\n  { name: 'James', comment: 'üíØ Always go for the sushi here', emoji: 'üç£', avatar: 'https://i.pravatar.cc/80?img=12' },\n  { name: 'Aisha', comment: 'üëå Perfect comfort food when tired', emoji: 'üç≤', avatar: 'https://i.pravatar.cc/80?img=58' },\n];\n\n// If /v1/recommend fails, we‚Äôll pick one of these locally:\nconst fallbackSuggestions = [\n  {\n    food: { emoji: 'üçú', name: 'Tonkotsu Ramen' },\n    friendMessage: 'Warming and soothing ‚Äî perfect for stressed vibes.',\n    availabilityNote: 'Try Koya Soho or Tonkotsu (open now)',\n    culturalNote: 'Ramen culture in London has exploded ‚Äî Soho has great late-night bowls.',\n    weatherNote: 'Rainy/cold? Hot broth hits just right.',\n    source: 'local-fallback',\n  },\n  {\n    food: { emoji: 'üç£', name: 'Sushi Set' },\n    friendMessage: 'Clean and fresh ‚Äî light but satisfying.',\n    availabilityNote: 'Sushi Atelier or Kanada-Ya nearby',\n    culturalNote: 'Japanese spots cluster around Fitzrovia & Soho.',\n    weatherNote: 'Great choice when you want something not too heavy.',\n    source: 'local-fallback',\n  },\n  {\n    food: { emoji: 'ü•ô', name: 'Mezze Plate' },\n    friendMessage: 'Shareable, bright flavors, and not heavy.',\n    availabilityNote: 'Check Arabica Borough or a local Levantine spot',\n    culturalNote: 'London‚Äôs Middle Eastern scene is strong ‚Äî Borough & Edgware Road.',\n    weatherNote: 'Good in any weather; easy on the stomach.',\n    source: 'local-fallback',\n  },\n];\n\n// ---------------- App State ----------------\nlet localGems = [];\nlet travelLists = {};\nlet eventItems = [];\nlet currentTab = 'tabTravel';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  injectRuntimeStyles();\n  mountToastHost();\n\n  wireCoreEvents();\n  wireTabs();\n\n  renderFriendChips();\n  loadLocalGems();\n  loadTravelLists();\n  loadEvents();\n\n  updateStatsUI(); // show stored counters if any\n\n  console.log('üöÄ VFIED unified main loaded');\n});\n\n// ---------------- Core One-Button Flow ----------------\nfunction wireCoreEvents() {\n  const decideBtn = byId('decide-button');\n  const detectBtn = byId('detect-mood-btn');\n  const acceptBtn = byId('accept-btn');\n  const tryAgainBtn = byId('try-again-btn');\n  const insightsToggle = byId('insights-toggle');\n\n  decideBtn && decideBtn.addEventListener('click', handleDecision);\n  detectBtn && detectBtn.addEventListener('click', detectMood);\n  acceptBtn && acceptBtn.addEventListener('click', handleAccept);\n  tryAgainBtn && tryAgainBtn.addEventListener('click', handleTryAgain);\n\n  insightsToggle &&\n    insightsToggle.addEventListener('click', () => {\n      const content = byId('insights-content');\n      const hidden = content.classList.contains('hidden');\n      if (hidden) {\n        content.classList.remove('hidden');\n        insightsToggle.textContent = 'ü§ñ Hide insights ‚Üë';\n      } else {\n        content.classList.add('hidden');\n        insightsToggle.textContent = 'ü§ñ Why this choice? ‚Üì';\n      }\n    });\n\n  // Local Gems modal\n  const seeMoreBtn = byId('see-more-gems');\n  const modal = byId('gems-modal');\n  const closeBtn = byId('gems-modal-close');\n\n  seeMoreBtn &&\n    seeMoreBtn.addEventListener('click', () => {\n      populateGemsModal();\n      openModal(modal);\n    });\n\n  closeBtn && closeBtn.addEventListener('click', () => closeModal(modal));\n  modal && modal.addEventListener('click', (e) => {\n    if (e.target === modal) closeModal(modal);\n  });\n}\n// Toggle the \"thinking\" state of the Decide button\nfunction setThinking(btn, on = true) {\n  try {\n    // accept element or lookup by id\n    const el = btn || document.getElementById('decide-button');\n    if (!el) return;\n\n    // disable/enable for UX\n    el.disabled = !!on;\n\n    // update icon/text if present\n    const icon = document.getElementById('button-icon');   // üéØ span\n    const text = document.getElementById('button-text');   // DECIDE FOR ME span\n\n    if (on) {\n      if (icon) icon.textContent = '‚è≥';\n      if (text) text.textContent = 'Thinking‚Ä¶';\n    } else {\n      if (icon) icon.textContent = 'üéØ';\n      if (text) text.textContent = 'DECIDE FOR ME';\n    }\n  } catch (e) {\n    console.warn('setThinking failed:', e);\n  }\n}\nasync function handleDecision() {\n  const decideBtn = byId('decide-button');\n  setThinking(decideBtn, true);\n  showSuggestionSkeleton();\n  updateContext('üß† Analyzing your mood, weather, and local options...');\n\n  try {\n    const mood = (byId('mood-input')?.value || '').trim() || 'hungry';\n    const prefs = getUserPrefs();\n\n    const payload = {\n      location: { city: 'London', country: 'United Kingdom', country_code: 'GB' },\n      mood_text: mood,\n      dietary: prefs.dietary || [],\n      budget: prefs.budget || 'medium',\n      menu_source: 'global_database',\n    };\n\n    const res = await fetch(`${API_BASE}/v1/recommend`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(payload),\n    });\n\n    if (!res.ok) throw new Error(`HTTP ${res.status}: ${res.statusText}`);\n    const s = await res.json();\n\n    // Enrich with social signals\n    const enriched = addSocialSignals(s);\n    showSuggestion(enriched);\n\n    // track stats (success)\n    incrementStats({ timeSavedMin: 3 }); // optimistic: ~3 min saved per quick decision\n  } catch (err) {\n    console.error(err);\n    const fallback = addSocialSignals(sample(fallbackSuggestions));\n    showSuggestion(fallback);\n    updateContext('‚ö†Ô∏è Server unavailable ‚Äî using a local fallback.');\n    toast('‚ö†Ô∏è Using offline suggestion (server unavailable).', 'warn');\n  } finally {\n    hideSuggestionSkeleton();\n    setThinking(decideBtn, false);\n  }\n}\n\nfunction showSuggestion(s) {\n  show('suggestion-result');\n\n  setText('result-emoji', s.food?.emoji || 'üçΩÔ∏è');\n  setText('result-name', s.food?.name || 'Something delicious');\n  setText('result-description', s.friendMessage || s.reasoning || 'Perfect for your mood!');\n  setText('restaurant-info', s.availabilityNote || '');\n\n  // insights\n  setHTML('cultural-note', s.culturalNote ? `<strong>üåç Cultural insight</strong><br>${s.culturalNote}` : '');\n  setHTML('personal-note', s.personalNote ? `<strong>üß† Personal note</strong><br>${s.personalNote}` : '');\n  setHTML('weather-note', s.weatherNote ? `<strong>üå§Ô∏è Weather</strong><br>${s.weatherNote}` : '');\n\n  // social\n  renderSocialSignals(s);\n\n  updateContext('üéâ Perfect match found! How does this sound?');\n}\n\nfunction handleAccept() {\n  hide('suggestion-result');\n  updateContext('üéâ Decision made! Ready for your next food adventure.');\n  toast('‚úÖ Enjoy your meal!', 'success');\n}\n\nfunction handleTryAgain() {\n  hide('suggestion-result');\n  handleDecision();\n}\n\n// ---------------- Social Layer ----------------\nfunction renderFriendChips() {\n  const container = byId('friend-chips');\n  if (!container) return;\n\n  container.innerHTML = '';\n  demoFriends.forEach((f) => {\n    const btn = document.createElement('button');\n    btn.className = 'friend-chip';\n    btn.innerHTML = `\n      <img class=\"friend-avatar\" src=\"${f.avatar}\" alt=\"${escapeHtml(f.name)}\" />\n      <span>${f.emoji} <strong>${escapeHtml(f.name)}</strong></span>\n    `;\n    btn.addEventListener('click', () => askFriend(f.name));\n    container.appendChild(btn);\n  });\n}\n\nfunction askFriend(name) {\n  const f = demoFriends.find((x) => x.name === name);\n  if (!f) return;\n  toast(`üí¨ Asking ${f.name}: ‚Äú${f.comment}‚Äù`, 'info');\n  const moodInput = byId('mood-input');\n  if (moodInput) {\n    if (f.emoji === 'üçú') moodInput.value = 'need something warming and comforting';\n    else if (f.emoji === 'üç£') moodInput.value = 'feeling adventurous, want something fresh';\n    else moodInput.value = 'need comfort food';\n  }\n}\n\nfunction addSocialSignals(suggestion) {\n  const foodName = (suggestion.food?.name || '').toLowerCase();\n  let friend = demoFriends[Math.floor(Math.random() * demoFriends.length)];\n  if (foodName.includes('ramen') || foodName.includes('noodle')) friend = demoFriends[0];\n  if (foodName.includes('sushi') || foodName.includes('japanese')) friend = demoFriends[1];\n\n  suggestion.socialSignal = {\n    type: 'friend',\n    friend,\n    message: `${friend.name}: ‚Äú${friend.comment}‚Äù`,\n  };\n\n  if (localGems.length) {\n    const g = localGems[Math.floor(Math.random() * localGems.length)];\n    suggestion.localSignal = { type: 'local_list', list: g, message: `Popular in ‚Äú${g.name}‚Äù (${g.area})` };\n  }\n  return suggestion;\n}\n\nfunction renderSocialSignals(s) {\n  const slot = byId('social-signals');\n  if (!slot) return;\n\n  let html = '';\n  if (s.socialSignal) {\n    html += `\n      <div class=\"social-signal friend-signal\">\n        <span class=\"signal-icon\">üë•</span>\n        <span class=\"signal-text\">${s.socialSignal.message}</span>\n      </div>`;\n  }\n  if (s.localSignal) {\n    html += `\n      <div class=\"social-signal local-signal\">\n        <span class=\"signal-icon\">üìç</span>\n        <span class=\"signal-text\">${s.localSignal.message}</span>\n      </div>`;\n  }\n  slot.innerHTML = html;\n}\n\n// ---------------- Local Gems ----------------\nasync function loadLocalGems() {\n  try {\n    const res = await fetch('/data/local_lists.json', { cache: 'no-store' });\n    localGems = await res.json();\n  } catch {\n    localGems = []; // fallback\n  }\n  renderLocalGemsGrid();\n}\n\nfunction renderLocalGemsGrid() {\n  const grid = byId('local-gems-grid');\n  if (!grid) return;\n\n  const first = localGems.slice(0, 8);\n  grid.innerHTML = '';\n  first.forEach((g) => {\n    const card = document.createElement('div');\n    card.className = 'gem-card';\n    card.innerHTML = `\n      <div class=\"gem-emoji\">${g.emoji}</div>\n      <div class=\"gem-name\">${escapeHtml(g.name)}</div>\n      <div class=\"gem-area\">${escapeHtml(g.area)}</div>\n    `;\n    card.addEventListener('click', () => exploreGem(g.name));\n    grid.appendChild(card);\n  });\n}\n\nfunction exploreGem(name) {\n  const g = localGems.find((x) => x.name === name);\n  if (!g) return;\n  const moodInput = byId('mood-input');\n  if (moodInput) moodInput.value = `want something from ${g.name} list in ${g.area}`;\n  handleDecision();\n}\n\nfunction populateGemsModal() {\n  const list = byId('gems-modal-list');\n  if (!list) return;\n  list.innerHTML = localGems\n    .map(\n      (g) => `\n      <li>\n        <span style=\"font-size:18px;margin-right:6px;\">${g.emoji}</span>\n        <strong>${g.name}</strong> <span style=\"opacity:.8\">‚Ä¢ ${g.area}</span>\n      </li>`\n    )\n    .join('');\n}\n\n// ---------------- Travel ----------------\nasync function loadTravelLists() {\n  try {\n    const res = await fetch('/data/travel_lists.json', { cache: 'no-store' });\n    travelLists = await res.json();\n  } catch {\n    travelLists = {};\n  }\n  renderTravelCities();\n  renderTravelGrid();\n}\n\nfunction renderTravelCities() {\n  const select = byId('travel-city-select');\n  if (!select) return;\n\n  const cities = Object.keys(travelLists);\n  select.innerHTML = cities.map((c) => `<option value=\"${c}\">${c}</option>`).join('');\n\n  select.addEventListener('change', () => renderTravelGrid());\n}\n\nfunction renderTravelGrid() {\n  const city = byId('travel-city-select')?.value || Object.keys(travelLists)[0];\n  const items = (travelLists[city] || []).slice(0, 10);\n  const grid = byId('travel-grid');\n  if (!grid) return;\n\n  grid.innerHTML = '';\n  items.forEach((t) => {\n    const card = document.createElement('div');\n    card.className = 'travel-card';\n    card.innerHTML = `\n      <div class=\"travel-emoji\">${t.emoji}</div>\n      <div class=\"travel-body\">\n        <div class=\"travel-title\">${escapeHtml(t.name)}</div>\n        <div class=\"travel-note\">${escapeHtml(t.note || '')}</div>\n      </div>\n    `;\n    card.addEventListener('click', () => tryTravel(city, t.name));\n    grid.appendChild(card);\n  });\n}\n\nfunction tryTravel(city, itemName) {\n  const moodInput = byId('mood-input');\n  if (moodInput) moodInput.value = `travel mode: try ${itemName} in ${city}`;\n  handleDecision();\n}\n\n// ---------------- Events Near Me ----------------\nasync function loadEvents() {\n  try {\n    const res = await fetch('/data/events.json', { cache: 'no-store' });\n    eventItems = await res.json();\n  } catch {\n    eventItems = [];\n  }\n  renderEvents();\n}\n\nfunction renderEvents() {\n  const grid = byId('events-grid');\n  if (!grid) return;\n\n  grid.innerHTML = '';\n  eventItems.forEach((e) => {\n    const card = document.createElement('div');\n    card.className = 'event-card';\n\n    const badge = document.createElement('div');\n    badge.className = 'event-badge';\n    badge.textContent = e.emoji;\n\n    const body = document.createElement('div');\n    body.className = 'event-body';\n\n    const title = document.createElement('div');\n    title.className = 'event-title';\n    title.textContent = e.title;\n\n    const meta = document.createElement('div');\n    meta.className = 'event-meta';\n    meta.textContent = `${e.date} ‚Ä¢ ${e.area} ‚Ä¢ ${e.price || 'Free'}`;\n\n    const cta = document.createElement('div');\n    cta.className = 'event-cta';\n\n    const detailsBtn = document.createElement('button');\n    detailsBtn.className = 'insights-toggle';\n    detailsBtn.textContent = 'Details';\n    detailsBtn.addEventListener('click', () => goEvent(e.title));\n\n    const mapsBtn = document.createElement('button');\n    mapsBtn.className = 'insights-toggle';\n    mapsBtn.textContent = 'Directions';\n    mapsBtn.addEventListener('click', () => goMaps(encodeURIComponent(e.map || e.title)));\n\n    cta.append(detailsBtn, mapsBtn);\n    body.append(title, meta, cta);\n    card.append(badge, body);\n    grid.appendChild(card);\n  });\n}\n\n\nfunction goEvent(title) {\n  toast(`üé™ ${title}\\n(Integrate ticket link or detail view here)`, 'info');\n}\nfunction goMaps(q) {\n  window.open(`https://www.google.com/maps/search/?api=1&query=${q}`, '_blank');\n}\n\n// ---------------- Tabs ----------------\nfunction wireTabs() {\n  document.querySelectorAll('.tab-btn').forEach((btn) => {\n    btn.addEventListener('click', () => {\n      document.querySelectorAll('.tab-btn').forEach((b) => b.classList.remove('active'));\n      btn.classList.add('active');\n\n      const toShow = btn.dataset.tab;\n      document.querySelectorAll('.tabpanel').forEach((p) => p.classList.add('hidden'));\n      byId(toShow)?.classList.remove('hidden');\n      currentTab = toShow;\n    });\n  });\n}\n\n// ---------------- Mood ----------------\nfunction detectMood() {\n  const input = byId('mood-input');\n  const val = input?.value?.trim();\n  if (!val) return toast('üß† Please enter your mood first!', 'warn');\n  toast('üß† Mood analyzed ‚Äî using it in your next suggestion!', 'info');\n  handleDecision();\n}\n\n// ---------------- Stats ----------------\nfunction incrementStats({ timeSavedMin = 2 } = {}) {\n  const raw = localStorage.getItem('vfied_stats');\n  const stats = raw ? JSON.parse(raw) : { totalDecisions: 0, timeSaved: 0 };\n  stats.totalDecisions += 1;\n  stats.timeSaved += timeSavedMin;\n  localStorage.setItem('vfied_stats', JSON.stringify(stats));\n  updateStatsUI();\n}\n\nfunction updateStatsUI() {\n  const raw = localStorage.getItem('vfied_stats');\n  const stats = raw ? JSON.parse(raw) : { totalDecisions: 0, timeSaved: 0 };\n  setText('decisions-count', stats.totalDecisions);\n  setText('time-saved', stats.timeSaved);\n}\n\n// ---------------- Skeleton UI ----------------\nfunction showSuggestionSkeleton() {\n  // show the skeleton section and hide the real result container\n  const skel = byId('suggestion-skeleton');\n  const res = byId('suggestion-result');\n  if (skel) skel.classList.remove('hidden');\n  if (res) res.classList.add('hidden');\n}\n\nfunction hideSuggestionSkeleton() {\n  // hide the skeleton; showSuggestion() will reveal the real result\n  const skel = byId('suggestion-skeleton');\n  if (skel) skel.classList.add('hidden');\n}\n\n// ---------------- Toasts ----------------\nfunction mountToastHost() {\n  if (byId('vfied-toast-host')) return;\n  const host = document.createElement('div');\n  host.id = 'vfied-toast-host';\n  document.body.appendChild(host);\n}\nfunction toast(msg, type = 'info') {\n  const host = byId('vfied-toast-host');\n  if (!host) return console.log(msg);\n  const el = document.createElement('div');\n  el.className = `vfied-toast ${type}`;\n  el.textContent = msg;\n  host.appendChild(el);\n  // animate in\n  requestAnimationFrame(() => el.classList.add('show'));\n  // auto remove\n  setTimeout(() => {\n    el.classList.remove('show');\n    setTimeout(() => host.removeChild(el), 250);\n  }, 2600);\n}\n\n// ---------------- Runtime Styles (toasts + skeleton) ----------------\nfunction injectRuntimeStyles() {\n  if (document.getElementById('vfied-runtime-styles')) return;\n  const css = `\n  #vfied-toast-host {\n    position: fixed; left: 50%; bottom: 24px; transform: translateX(-50%);\n    display: flex; flex-direction: column; gap: 8px; z-index: 9999; pointer-events: none;\n  }\n  .vfied-toast {\n    pointer-events: auto;\n    min-width: 240px; max-width: 92vw;\n    padding: 10px 14px; border-radius: 10px; backdrop-filter: blur(8px);\n    background: rgba(0,0,0,.65); color: #fff; font-weight: 600; font-size: 14px;\n    opacity: 0; transform: translateY(8px); transition: all .25s ease;\n    border: 1px solid rgba(255,255,255,.15);\n  }\n  .vfied-toast.show { opacity: 1; transform: translateY(0); }\n  .vfied-toast.success { background: rgba(34,197,94,.85); }\n  .vfied-toast.warn { background: rgba(245,158,11,.9); }\n  .vfied-toast.error { background: rgba(239,68,68,.9); }\n\n  .skeleton-card {\n    background: rgba(255,255,255,.12); border: 1px solid rgba(255,255,255,.18);\n    border-radius: 16px; padding: 18px; max-width: 420px; margin: 8px auto;\n  }\n  .sk-line {\n    height: 14px; margin: 10px 0;\n    background: linear-gradient(90deg, rgba(255,255,255,.15), rgba(255,255,255,.25), rgba(255,255,255,.15));\n    background-size: 200% 100%; animation: sk-shimmer 1.4s infinite;\n    border-radius: 8px;\n  }\n  .sk-emoji { height: 46px; width: 46px; border-radius: 50%; margin: 0 auto 10px; }\n  .sk-title { height: 18px; width: 70%; margin: 12px auto; }\n  .sk-sub { width: 90%; margin: 10px auto; }\n  .sk-sub.short { width: 60%; }\n  @keyframes sk-shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }\n\n  /* Friend avatar chip (if your CSS doesn't already style it) */\n  .friend-chip { display:inline-flex; align-items:center; gap:8px; }\n  .friend-avatar { width:22px; height:22px; border-radius:50%; object-fit:cover; }\n  `;\n  const style = document.createElement('style');\n  style.id = 'vfied-runtime-styles';\n  style.textContent = css;\n  document.head.appendChild(style);\n}\n\n// ---------------- Utils ----------------\nfunction byId(id) {\n  const el = document.getElementById(id);\n  // console.warn on missing but don't spam constantly\n  return el;\n}\nfunction setText(id, text) {\n  const el = byId(id);\n  if (el) el.textContent = text;\n}\nfunction setHTML(id, html) {\n  const el = byId(id);\n  if (el) el.innerHTML = html;\n}\nfunction show(id) {\n  const el = byId(id);\n  if (el) el.classList.remove('hidden');\n}\nfunction hide(id) {\n  const el = byId(id);\n  if (el) el.classList.add('hidden');\n}\nfunction updateContext(msg) {\n  setText('context-info', msg);\n}\nfunction sample(a) {\n  return a[Math.floor(Math.random() * a.length)];\n}\n\nfunction escapeHtml(s) {\n  return String(s).replace(/[&<>\"']/g, (m) => (\n    { '&': '&amp;', '<': '&lt;', '>': '&gt;', '\"': '&quot;', \"'\": '&#039;' }[m]\n  ));\n}\n// User prefs (stub for now)\nfunction getUserPrefs() {\n  try {\n    return JSON.parse(localStorage.getItem('vfied_prefs') || '{}');\n  } catch {\n    return {};\n  }\n}\n\n// Modal helpers\nfunction openModal(m) {\n  if (!m) return;\n  m.setAttribute('aria-hidden', 'false');\n  m.classList.add('open');\n}\nfunction closeModal(m) {\n  if (!m) return;\n  m.setAttribute('aria-hidden', 'true');\n  m.classList.remove('open');\n}\n\n// Expose helpers for inline onclick\nwindow.VFIED = {\n  askFriend,\n  exploreGem,\n  tryTravel,\n  goEvent,\n  goMaps,\n};\n"],"names":["API_BASE","window","__API__","demoFriends","name","comment","emoji","avatar","fallbackSuggestions","food","friendMessage","availabilityNote","culturalNote","weatherNote","source","localGems","travelLists","eventItems","setThinking","btn","on","el","document","getElementById","disabled","icon","text","textContent","e","console","warn","async","handleDecision","decideBtn","byId","skel","res","classList","remove","add","showSuggestionSkeleton","updateContext","mood","value","trim","prefs","JSON","parse","localStorage","getItem","getUserPrefs","payload","location","city","country","country_code","mood_text","dietary","budget","menu_source","fetch","method","headers","body","stringify","ok","Error","status","statusText","s","json","showSuggestion","addSocialSignals","timeSavedMin","raw","stats","totalDecisions","timeSaved","setItem","updateStatsUI","incrementStats","err","error","a","Math","floor","random","length","toast","hideSuggestionSkeleton","id","show","setText","reasoning","setHTML","personalNote","slot","html","socialSignal","message","localSignal","innerHTML","renderSocialSignals","handleAccept","hide","handleTryAgain","askFriend","f","find","x","moodInput","suggestion","foodName","toLowerCase","friend","includes","type","g","list","area","exploreGem","renderTravelGrid","Object","keys","items","slice","grid","forEach","t","card","createElement","className","escapeHtml","note","addEventListener","tryTravel","appendChild","itemName","goEvent","title","goMaps","q","open","detectMood","input","val","msg","host","log","requestAnimationFrame","setTimeout","removeChild","String","replace","m","closeModal","setAttribute","css","style","head","injectRuntimeStyles","mountToastHost","detectBtn","acceptBtn","tryAgainBtn","insightsToggle","content","contains","seeMoreBtn","modal","closeBtn","map","join","populateGemsModal","target","wireCoreEvents","querySelectorAll","b","toShow","dataset","tab","p","container","renderFriendChips","cache","first","renderLocalGemsGrid","loadLocalGems","select","cities","c","renderTravelCities","loadTravelLists","badge","meta","date","price","cta","detailsBtn","mapsBtn","encodeURIComponent","append","renderEvents","loadEvents","VFIED"],"mappings":"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"}