function re(){import.meta.url,import("_").catch(()=>1),(async function*(){})().next()}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();const w=new URLSearchParams(location.search).get("api");w&&localStorage.setItem("vfied_api",w);const B=localStorage.getItem("vfied_api"),H=typeof window<"u"&&window.__API__||"",x=(w||B||H||"").replace(/\/$/,"");console.log("API_BASE ->",x||"(same-origin)");const m=[{name:"Sarah",comment:"üî• Best ramen spot ever!",emoji:"üçú",avatar:"https://i.pravatar.cc/80?img=32"},{name:"James",comment:"üíØ Always go for the sushi here",emoji:"üç£",avatar:"https://i.pravatar.cc/80?img=12"},{name:"Aisha",comment:"üëå Perfect comfort food when tired",emoji:"üç≤",avatar:"https://i.pravatar.cc/80?img=58"}],P=[{food:{emoji:"üçú",name:"Tonkotsu Ramen"},friendMessage:"Warming and soothing ‚Äî perfect for stressed vibes.",availabilityNote:"Try Koya Soho or Tonkotsu (open now)",culturalNote:"Ramen culture in London has exploded ‚Äî Soho has great late-night bowls.",weatherNote:"Rainy/cold? Hot broth hits just right.",source:"local-fallback"},{food:{emoji:"üç£",name:"Sushi Set"},friendMessage:"Clean and fresh ‚Äî light but satisfying.",availabilityNote:"Sushi Atelier or Kanada-Ya nearby",culturalNote:"Japanese spots cluster around Fitzrovia & Soho.",weatherNote:"Great choice when you want something not too heavy.",source:"local-fallback"},{food:{emoji:"ü•ô",name:"Mezze Plate"},friendMessage:"Shareable, bright flavors, and not heavy.",availabilityNote:"Check Arabica Borough or a local Levantine spot",culturalNote:"Londons Middle Eastern scene is strong ‚Äî Borough & Edgware Road.",weatherNote:"Good in any weather; easy on the stomach.",source:"local-fallback"}];let d=[],p={},L=[];document.addEventListener("DOMContentLoaded",()=>{ne(),te(),O(),V(),G(),R(),U(),W(),A(),console.log("üöÄ VFIED unified main loaded")});function O(){const e=i("decide-button"),t=i("detect-mood-btn"),n=i("accept-btn"),o=i("try-again-btn"),a=i("insights-toggle");e&&e.addEventListener("click",v),t&&t.addEventListener("click",X),n&&n.addEventListener("click",D),o&&o.addEventListener("click",F),a&&a.addEventListener("click",()=>{const c=i("insights-content");c.classList.contains("hidden")?(c.classList.remove("hidden"),a.textContent="ü§ñ Hide insights ‚Üë"):(c.classList.add("hidden"),a.textContent="ü§ñ Why this choice? ‚Üì")});const s=i("see-more-gems"),r=i("gems-modal"),l=i("gems-modal-close");s&&s.addEventListener("click",()=>{J(),se(r)}),l&&l.addEventListener("click",()=>$(r)),r&&r.addEventListener("click",c=>{c.target===r&&$(r)})}function E(e,t=!0){try{const n=e||document.getElementById("decide-button");if(!n)return;n.disabled=!!t;const o=document.getElementById("button-icon"),a=document.getElementById("button-text");t?(o&&(o.textContent="‚è≥"),a&&(a.textContent="Thinking‚Ä¶")):(o&&(o.textContent="üéØ"),a&&(a.textContent="DECIDE FOR ME"))}catch(n){console.warn("setThinking failed:",n)}}async function v(){var t;const e=i("decide-button");E(e,!0),Z(),y("üß† Analyzing your mood, weather, and local options...");try{const n=(((t=i("mood-input"))==null?void 0:t.value)||"").trim()||"hungry",o=ie(),a={location:{city:"London",country:"United Kingdom",country_code:"GB"},mood_text:n,dietary:o.dietary||[],budget:o.budget||"medium",menu_source:"global_database"},s=x?"".concat(x,"/v1/recommend"):"/v1/recommend",r=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!r.ok)throw new Error("HTTP ".concat(r.status,": ").concat(r.statusText));const l=await r.json(),c=k(l);S(c),Q({timeSavedMin:3})}catch(n){console.error(n);const o=k(ae(P));S(o),y("‚ö†Ô∏è Server unavailable ‚Äî using a local fallback."),f("‚ö†Ô∏è Using offline suggestion (server unavailable).","warn")}finally{ee(),E(e,!1)}}function S(e){var t,n;oe("suggestion-result"),u("result-emoji",((t=e.food)==null?void 0:t.emoji)||"üçΩÔ∏è"),u("result-name",((n=e.food)==null?void 0:n.name)||"Something delicious"),u("result-description",e.friendMessage||e.reasoning||"Perfect for your mood!"),u("restaurant-info",e.availabilityNote||""),b("cultural-note",e.culturalNote?"<strong>üåç Cultural insight</strong><br>".concat(e.culturalNote):""),b("personal-note",e.personalNote?"<strong>üß† Personal note</strong><br>".concat(e.personalNote):""),b("weather-note",e.weatherNote?"<strong>üå§Ô∏è Weather</strong><br>".concat(e.weatherNote):""),z(e),y("üéâ Perfect match found! How does this sound?")}function D(){_("suggestion-result"),y("üéâ Decision made! Ready for your next food adventure."),f("‚úÖ Enjoy your meal!","success")}function F(){_("suggestion-result"),v()}function G(){const e=i("friend-chips");e&&(e.innerHTML="",m.forEach(t=>{const n=document.createElement("button");n.className="friend-chip",n.innerHTML='\n      <img class="friend-avatar" src="'.concat(t.avatar,'" alt="').concat(g(t.name),'" />\n      <span>').concat(t.emoji," <strong>").concat(g(t.name),"</strong></span>\n    "),n.addEventListener("click",()=>N(t.name)),e.appendChild(n)}))}function N(e){const t=m.find(o=>o.name===e);if(!t)return;f("üí¨ Asking ".concat(t.name,': "').concat(t.comment,'"'),"info");const n=i("mood-input");n&&(t.emoji==="üçú"?n.value="need something warming and comforting":t.emoji==="üç£"?n.value="feeling adventurous, want something fresh":n.value="need comfort food")}function k(e){var o;const t=(((o=e.food)==null?void 0:o.name)||"").toLowerCase();let n=m[Math.floor(Math.random()*m.length)];if((t.includes("ramen")||t.includes("noodle"))&&(n=m[0]),(t.includes("sushi")||t.includes("japanese"))&&(n=m[1]),e.socialSignal={type:"friend",friend:n,message:"".concat(n.name,': "').concat(n.comment,'"')},d.length){const a=d[Math.floor(Math.random()*d.length)];e.localSignal={type:"local_list",list:a,message:'Popular in "'.concat(a.name,'" (').concat(a.area,")")}}return e}function z(e){const t=i("social-signals");if(!t)return;let n="";e.socialSignal&&(n+='\n      <div class="social-signal friend-signal">\n        <span class="signal-icon">üë•</span>\n        <span class="signal-text">'.concat(e.socialSignal.message,"</span>\n      </div>")),e.localSignal&&(n+='\n      <div class="social-signal local-signal">\n        <span class="signal-icon">üìç</span>\n        <span class="signal-text">'.concat(e.localSignal.message,"</span>\n      </div>")),t.innerHTML=n}async function R(){try{d=await(await fetch("/data/local_lists.json",{cache:"no-store"})).json()}catch(e){d=[]}q()}function q(){const e=i("local-gems-grid");if(!e)return;const t=d.slice(0,8);e.innerHTML="",t.forEach(n=>{const o=document.createElement("div");o.className="gem-card",o.innerHTML='\n      <div class="gem-emoji">'.concat(n.emoji,'</div>\n      <div class="gem-name">').concat(g(n.name),'</div>\n      <div class="gem-area">').concat(g(n.area),"</div>\n    "),o.addEventListener("click",()=>j(n.name)),e.appendChild(o)})}function j(e){const t=d.find(o=>o.name===e);if(!t)return;const n=i("mood-input");n&&(n.value="want something from ".concat(t.name," list in ").concat(t.area)),v()}function J(){const e=i("gems-modal-list");e&&(e.innerHTML=d.map(t=>'\n      <li>\n        <span style="font-size:18px;margin-right:6px;">'.concat(t.emoji,"</span>\n        <strong>").concat(t.name,'</strong> <span style="opacity:.8">‚Ä¢ ').concat(t.area,"</span>\n      </li>")).join(""))}async function U(){try{p=await(await fetch("/data/travel_lists.json",{cache:"no-store"})).json()}catch(e){p={}}K(),C()}function K(){const e=i("travel-city-select");if(!e)return;const t=Object.keys(p);e.innerHTML=t.map(n=>'<option value="'.concat(n,'">').concat(n,"</option>")).join(""),e.addEventListener("change",()=>C())}function C(){var o;const e=((o=i("travel-city-select"))==null?void 0:o.value)||Object.keys(p)[0],t=(p[e]||[]).slice(0,10),n=i("travel-grid");n&&(n.innerHTML="",t.forEach(a=>{const s=document.createElement("div");s.className="travel-card",s.innerHTML='\n      <div class="travel-emoji">'.concat(a.emoji,'</div>\n      <div class="travel-body">\n        <div class="travel-title">').concat(g(a.name),'</div>\n        <div class="travel-note">').concat(g(a.note||""),"</div>\n      </div>\n    "),s.addEventListener("click",()=>M(e,a.name)),n.appendChild(s)}))}function M(e,t){const n=i("mood-input");n&&(n.value="travel mode: try ".concat(t," in ").concat(e)),v()}async function W(){try{L=await(await fetch("/data/events.json",{cache:"no-store"})).json()}catch(e){L=[]}Y()}function Y(){const e=i("events-grid");e&&(e.innerHTML="",L.forEach(t=>{const n=document.createElement("div");n.className="event-card";const o=document.createElement("div");o.className="event-badge",o.textContent=t.emoji;const a=document.createElement("div");a.className="event-body";const s=document.createElement("div");s.className="event-title",s.textContent=t.title;const r=document.createElement("div");r.className="event-meta",r.textContent="".concat(t.date," ‚Ä¢ ").concat(t.area," ‚Ä¢ ").concat(t.price||"Free");const l=document.createElement("div");l.className="event-cta";const c=document.createElement("button");c.className="insights-toggle",c.textContent="Details",c.addEventListener("click",()=>T(t.title));const h=document.createElement("button");h.className="insights-toggle",h.textContent="Directions",h.addEventListener("click",()=>I(encodeURIComponent(t.map||t.title))),l.append(c,h),a.append(s,r,l),n.append(o,a),e.appendChild(n)}))}function T(e){f("üé™ ".concat(e,"\n(Integrate ticket link or detail view here)"),"info")}function I(e){window.open("https://www.google.com/maps/search/?api=1&query=".concat(e),"_blank")}function V(){document.querySelectorAll(".tab-btn").forEach(e=>{e.addEventListener("click",()=>{var n;document.querySelectorAll(".tab-btn").forEach(o=>o.classList.remove("active")),e.classList.add("active");const t=e.dataset.tab;document.querySelectorAll(".tabpanel").forEach(o=>o.classList.add("hidden")),(n=i(t))==null||n.classList.remove("hidden")})})}function X(){var n;const e=i("mood-input");if(!((n=e==null?void 0:e.value)==null?void 0:n.trim()))return f("üß† Please enter your mood first!","warn");f("üß† Mood analyzed ‚Äî using it in your next suggestion!","info"),v()}function Q({timeSavedMin:e=2}={}){const t=localStorage.getItem("vfied_stats"),n=t?JSON.parse(t):{totalDecisions:0,timeSaved:0};n.totalDecisions+=1,n.timeSaved+=e,localStorage.setItem("vfied_stats",JSON.stringify(n)),A()}function A(){const e=localStorage.getItem("vfied_stats"),t=e?JSON.parse(e):{totalDecisions:0,timeSaved:0};u("decisions-count",t.totalDecisions),u("time-saved",t.timeSaved)}function Z(){const e=i("suggestion-skeleton"),t=i("suggestion-result");e&&e.classList.remove("hidden"),t&&t.classList.add("hidden")}function ee(){const e=i("suggestion-skeleton");e&&e.classList.add("hidden")}function te(){if(i("vfied-toast-host"))return;const e=document.createElement("div");e.id="vfied-toast-host",document.body.appendChild(e)}function f(e,t="info"){const n=i("vfied-toast-host");if(!n)return console.log(e);const o=document.createElement("div");o.className="vfied-toast ".concat(t),o.textContent=e,n.appendChild(o),requestAnimationFrame(()=>o.classList.add("show")),setTimeout(()=>{o.classList.remove("show"),setTimeout(()=>n.removeChild(o),250)},2600)}function ne(){if(document.getElementById("vfied-runtime-styles"))return;const e="\n  #vfied-toast-host {\n    position: fixed; left: 50%; bottom: 24px; transform: translateX(-50%);\n    display: flex; flex-direction: column; gap: 8px; z-index: 9999; pointer-events: none;\n  }\n  .vfied-toast {\n    pointer-events: auto;\n    min-width: 240px; max-width: 92vw;\n    padding: 10px 14px; border-radius: 10px; backdrop-filter: blur(8px);\n    background: rgba(0,0,0,.65); color: #fff; font-weight: 600; font-size: 14px;\n    opacity: 0; transform: translateY(8px); transition: all .25s ease;\n    border: 1px solid rgba(255,255,255,.15);\n  }\n  .vfied-toast.show { opacity: 1; transform: translateY(0); }\n  .vfied-toast.success { background: rgba(34,197,94,.85); }\n  .vfied-toast.warn { background: rgba(245,158,11,.9); }\n  .vfied-toast.error { background: rgba(239,68,68,.9); }\n\n  .skeleton-card {\n    background: rgba(255,255,255,.12); border: 1px solid rgba(255,255,255,.18);\n    border-radius: 16px; padding: 18px; max-width: 420px; margin: 8px auto;\n  }\n  .sk-line {\n    height: 14px; margin: 10px 0;\n    background: linear-gradient(90deg, rgba(255,255,255,.15), rgba(255,255,255,.25), rgba(255,255,255,.15));\n    background-size: 200% 100%; animation: sk-shimmer 1.4s infinite;\n    border-radius: 8px;\n  }\n  .sk-emoji { height: 46px; width: 46px; border-radius: 50%; margin: 0 auto 10px; }\n  .sk-title { height: 18px; width: 70%; margin: 12px auto; }\n  .sk-sub { width: 90%; margin: 10px auto; }\n  .sk-sub.short { width: 60%; }\n  @keyframes sk-shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }\n\n  /* Friend avatar chip (if your CSS doesn't already style it) */\n  .friend-chip { display:inline-flex; align-items:center; gap:8px; }\n  .friend-avatar { width:22px; height:22px; border-radius:50%; object-fit:cover; }\n  ",t=document.createElement("style");t.id="vfied-runtime-styles",t.textContent=e,document.head.appendChild(t)}function i(e){return document.getElementById(e)}function u(e,t){const n=i(e);n&&(n.textContent=t)}function b(e,t){const n=i(e);n&&(n.innerHTML=t)}function oe(e){const t=i(e);t&&t.classList.remove("hidden")}function _(e){const t=i(e);t&&t.classList.add("hidden")}function y(e){u("context-info",e)}function ae(e){return e[Math.floor(Math.random()*e.length)]}function g(e){return String(e).replace(/[&<>"']/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"})[t])}function ie(){try{return JSON.parse(localStorage.getItem("vfied_prefs")||"{}")}catch(e){return{}}}function se(e){e&&(e.setAttribute("aria-hidden","false"),e.classList.add("open"))}function $(e){e&&(e.setAttribute("aria-hidden","true"),e.classList.remove("open"))}window.VFIED={askFriend:N,exploreGem:j,tryTravel:M,goEvent:T,goMaps:I};export{re as __vite_legacy_guard};
//# sourceMappingURL=index-CGgggJke.js.map
