{"version":3,"file":"index-legacy-h21rRsr-.js","sources":["../../app/src/main.js"],"sourcesContent":["// VFIED Unified Main (Food + Social + Travel + Events) ‚Äî with Toasts, Skeletons, Fallback & Stats\n\n// ---- Robust API base resolution ----\nconst qpApi = new URLSearchParams(location.search).get('api');\nif (qpApi) localStorage.setItem('vfied_api', qpApi);\n\nconst storedApi = localStorage.getItem('vfied_api');\nconst runtimeApi = (typeof window !== 'undefined' && window.__API__) || ''; // '' = same-origin\nexport const API_BASE = (qpApi || storedApi || runtimeApi || '').replace(/\\/$/, '');\n\nconsole.log('API_BASE ->', API_BASE || '(same-origin)');\n\n// ---------------- Demo / Fallback Data ----------------\nconst demoFriends = [\n  { name: 'Sarah', comment: 'üî• Best ramen spot ever!', emoji: 'üçú', avatar: 'https://i.pravatar.cc/80?img=32' },\n  { name: 'James', comment: 'üíØ Always go for the sushi here', emoji: 'üç£', avatar: 'https://i.pravatar.cc/80?img=12' },\n  { name: 'Aisha', comment: 'üëå Perfect comfort food when tired', emoji: 'üç≤', avatar: 'https://i.pravatar.cc/80?img=58' },\n];\n\n// If /v1/recommend fails, we'll pick one of these locally:\nconst fallbackSuggestions = [\n  {\n    food: { emoji: 'üçú', name: 'Tonkotsu Ramen' },\n    friendMessage: 'Warming and soothing ‚Äî perfect for stressed vibes.',\n    availabilityNote: 'Try Koya Soho or Tonkotsu (open now)',\n    culturalNote: 'Ramen culture in London has exploded ‚Äî Soho has great late-night bowls.',\n    weatherNote: 'Rainy/cold? Hot broth hits just right.',\n    source: 'local-fallback',\n  },\n  {\n    food: { emoji: 'üç£', name: 'Sushi Set' },\n    friendMessage: 'Clean and fresh ‚Äî light but satisfying.',\n    availabilityNote: 'Sushi Atelier or Kanada-Ya nearby',\n    culturalNote: 'Japanese spots cluster around Fitzrovia & Soho.',\n    weatherNote: 'Great choice when you want something not too heavy.',\n    source: 'local-fallback',\n  },\n  {\n    food: { emoji: 'ü•ô', name: 'Mezze Plate' },\n    friendMessage: 'Shareable, bright flavors, and not heavy.',\n    availabilityNote: 'Check Arabica Borough or a local Levantine spot',\n    culturalNote: 'Londons Middle Eastern scene is strong ‚Äî Borough & Edgware Road.',\n    weatherNote: 'Good in any weather; easy on the stomach.',\n    source: 'local-fallback',\n  },\n];\n\n// ---------------- App State ----------------\nlet localGems = [];\nlet travelLists = {};\nlet eventItems = [];\nlet currentTab = 'tabTravel';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  injectRuntimeStyles();\n  mountToastHost();\n\n  wireCoreEvents();\n  wireTabs();\n\n  renderFriendChips();\n  loadLocalGems();\n  loadTravelLists();\n  loadEvents();\n\n  updateStatsUI(); // show stored counters if any\n\n  console.log('üöÄ VFIED unified main loaded');\n});\n\n// ---------------- Core One-Button Flow ----------------\nfunction wireCoreEvents() {\n  const decideBtn = byId('decide-button');\n  const detectBtn = byId('detect-mood-btn');\n  const acceptBtn = byId('accept-btn');\n  const tryAgainBtn = byId('try-again-btn');\n  const insightsToggle = byId('insights-toggle');\n\n  decideBtn && decideBtn.addEventListener('click', handleDecision);\n  detectBtn && detectBtn.addEventListener('click', detectMood);\n  acceptBtn && acceptBtn.addEventListener('click', handleAccept);\n  tryAgainBtn && tryAgainBtn.addEventListener('click', handleTryAgain);\n\n  insightsToggle &&\n    insightsToggle.addEventListener('click', () => {\n      const content = byId('insights-content');\n      const hidden = content.classList.contains('hidden');\n      if (hidden) {\n        content.classList.remove('hidden');\n        insightsToggle.textContent = 'ü§ñ Hide insights ‚Üë';\n      } else {\n        content.classList.add('hidden');\n        insightsToggle.textContent = 'ü§ñ Why this choice? ‚Üì';\n      }\n    });\n\n  // Local Gems modal\n  const seeMoreBtn = byId('see-more-gems');\n  const modal = byId('gems-modal');\n  const closeBtn = byId('gems-modal-close');\n\n  seeMoreBtn &&\n    seeMoreBtn.addEventListener('click', () => {\n      populateGemsModal();\n      openModal(modal);\n    });\n\n  closeBtn && closeBtn.addEventListener('click', () => closeModal(modal));\n  modal && modal.addEventListener('click', (e) => {\n    if (e.target === modal) closeModal(modal);\n  });\n}\n\n// Toggle the \"thinking\" state of the Decide button\nfunction setThinking(btn, on = true) {\n  try {\n    // accept element or lookup by id\n    const el = btn || document.getElementById('decide-button');\n    if (!el) return;\n\n    // disable/enable for UX\n    el.disabled = !!on;\n\n    // update icon/text if present\n    const icon = document.getElementById('button-icon');   // üéØ span\n    const text = document.getElementById('button-text');   // DECIDE FOR ME span\n\n    if (on) {\n      if (icon) icon.textContent = '‚è≥';\n      if (text) text.textContent = 'Thinking‚Ä¶';\n    } else {\n      if (icon) icon.textContent = 'üéØ';\n      if (text) text.textContent = 'DECIDE FOR ME';\n    }\n  } catch (e) {\n    console.warn('setThinking failed:', e);\n  }\n}\n\nasync function handleDecision() {\n  const decideBtn = byId('decide-button');\n  setThinking(decideBtn, true);\n  showSuggestionSkeleton();\n  updateContext('üß† Analyzing your mood, weather, and local options...');\n\n  try {\n    const mood = (byId('mood-input')?.value || '').trim() || 'hungry';\n    const prefs = getUserPrefs();\n\n    const payload = {\n      location: { city: 'London', country: 'United Kingdom', country_code: 'GB' },\n      mood_text: mood,\n      dietary: prefs.dietary || [],\n      budget: prefs.budget || 'medium',\n      menu_source: 'global_database',\n    };\n\n    // Updated URL construction to avoid double slashes\n    const url = API_BASE ? `${API_BASE}/v1/recommend` : `/v1/recommend`;\n    const res = await fetch(url, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(payload),\n    });\n\n    if (!res.ok) throw new Error(`HTTP ${res.status}: ${res.statusText}`);\n    const s = await res.json();\n\n    // Enrich with social signals\n    const enriched = addSocialSignals(s);\n    showSuggestion(enriched);\n\n    // track stats (success)\n    incrementStats({ timeSavedMin: 3 }); // optimistic: ~3 min saved per quick decision\n  } catch (err) {\n    console.error(err);\n    const fallback = addSocialSignals(sample(fallbackSuggestions));\n    showSuggestion(fallback);\n    updateContext('‚ö†Ô∏è Server unavailable ‚Äî using a local fallback.');\n    toast('‚ö†Ô∏è Using offline suggestion (server unavailable).', 'warn');\n  } finally {\n    hideSuggestionSkeleton();\n    setThinking(decideBtn, false);\n  }\n}\n\nfunction showSuggestion(s) {\n  show('suggestion-result');\n\n  setText('result-emoji', s.food?.emoji || 'üçΩÔ∏è');\n  setText('result-name', s.food?.name || 'Something delicious');\n  setText('result-description', s.friendMessage || s.reasoning || 'Perfect for your mood!');\n  setText('restaurant-info', s.availabilityNote || '');\n\n  // insights\n  setHTML('cultural-note', s.culturalNote ? `<strong>üåç Cultural insight</strong><br>${s.culturalNote}` : '');\n  setHTML('personal-note', s.personalNote ? `<strong>üß† Personal note</strong><br>${s.personalNote}` : '');\n  setHTML('weather-note', s.weatherNote ? `<strong>üå§Ô∏è Weather</strong><br>${s.weatherNote}` : '');\n\n  // social\n  renderSocialSignals(s);\n\n  updateContext('üéâ Perfect match found! How does this sound?');\n}\n\nfunction handleAccept() {\n  hide('suggestion-result');\n  updateContext('üéâ Decision made! Ready for your next food adventure.');\n  toast('‚úÖ Enjoy your meal!', 'success');\n}\n\nfunction handleTryAgain() {\n  hide('suggestion-result');\n  handleDecision();\n}\n\n// ---------------- Social Layer ----------------\nfunction renderFriendChips() {\n  const container = byId('friend-chips');\n  if (!container) return;\n\n  container.innerHTML = '';\n  demoFriends.forEach((f) => {\n    const btn = document.createElement('button');\n    btn.className = 'friend-chip';\n    btn.innerHTML = `\n      <img class=\"friend-avatar\" src=\"${f.avatar}\" alt=\"${escapeHtml(f.name)}\" />\n      <span>${f.emoji} <strong>${escapeHtml(f.name)}</strong></span>\n    `;\n    btn.addEventListener('click', () => askFriend(f.name));\n    container.appendChild(btn);\n  });\n}\n\nfunction askFriend(name) {\n  const f = demoFriends.find((x) => x.name === name);\n  if (!f) return;\n  toast(`üí¨ Asking ${f.name}: \"${f.comment}\"`, 'info');\n  const moodInput = byId('mood-input');\n  if (moodInput) {\n    if (f.emoji === 'üçú') moodInput.value = 'need something warming and comforting';\n    else if (f.emoji === 'üç£') moodInput.value = 'feeling adventurous, want something fresh';\n    else moodInput.value = 'need comfort food';\n  }\n}\n\nfunction addSocialSignals(suggestion) {\n  const foodName = (suggestion.food?.name || '').toLowerCase();\n  let friend = demoFriends[Math.floor(Math.random() * demoFriends.length)];\n  if (foodName.includes('ramen') || foodName.includes('noodle')) friend = demoFriends[0];\n  if (foodName.includes('sushi') || foodName.includes('japanese')) friend = demoFriends[1];\n\n  suggestion.socialSignal = {\n    type: 'friend',\n    friend,\n    message: `${friend.name}: \"${friend.comment}\"`,\n  };\n\n  if (localGems.length) {\n    const g = localGems[Math.floor(Math.random() * localGems.length)];\n    suggestion.localSignal = { type: 'local_list', list: g, message: `Popular in \"${g.name}\" (${g.area})` };\n  }\n  return suggestion;\n}\n\nfunction renderSocialSignals(s) {\n  const slot = byId('social-signals');\n  if (!slot) return;\n\n  let html = '';\n  if (s.socialSignal) {\n    html += `\n      <div class=\"social-signal friend-signal\">\n        <span class=\"signal-icon\">üë•</span>\n        <span class=\"signal-text\">${s.socialSignal.message}</span>\n      </div>`;\n  }\n  if (s.localSignal) {\n    html += `\n      <div class=\"social-signal local-signal\">\n        <span class=\"signal-icon\">üìç</span>\n        <span class=\"signal-text\">${s.localSignal.message}</span>\n      </div>`;\n  }\n  slot.innerHTML = html;\n}\n\n// ---------------- Local Gems ----------------\nasync function loadLocalGems() {\n  try {\n    const url = API_BASE ? `${API_BASE}/data/local_lists.json` : `/data/local_lists.json`;\n    const res = await fetch(url, { cache: 'no-store' });\n    localGems = await res.json();\n  } catch {\n    localGems = []; // fallback\n  }\n  renderLocalGemsGrid();\n}\n\nfunction renderLocalGemsGrid() {\n  const grid = byId('local-gems-grid');\n  if (!grid) return;\n\n  const first = localGems.slice(0, 8);\n  grid.innerHTML = '';\n  first.forEach((g) => {\n    const card = document.createElement('div');\n    card.className = 'gem-card';\n    card.innerHTML = `\n      <div class=\"gem-emoji\">${g.emoji}</div>\n      <div class=\"gem-name\">${escapeHtml(g.name)}</div>\n      <div class=\"gem-area\">${escapeHtml(g.area)}</div>\n    `;\n    card.addEventListener('click', () => exploreGem(g.name));\n    grid.appendChild(card);\n  });\n}\n\nfunction exploreGem(name) {\n  const g = localGems.find((x) => x.name === name);\n  if (!g) return;\n  const moodInput = byId('mood-input');\n  if (moodInput) moodInput.value = `want something from ${g.name} list in ${g.area}`;\n  handleDecision();\n}\n\nfunction populateGemsModal() {\n  const list = byId('gems-modal-list');\n  if (!list) return;\n  list.innerHTML = localGems\n    .map(\n      (g) => `\n      <li>\n        <span style=\"font-size:18px;margin-right:6px;\">${g.emoji}</span>\n        <strong>${g.name}</strong> <span style=\"opacity:.8\">‚Ä¢ ${g.area}</span>\n      </li>`\n    )\n    .join('');\n}\n\n// ---------------- Travel ----------------\nasync function loadTravelLists() {\n  try {\n    const url = API_BASE ? `${API_BASE}/data/travel_lists.json` : `/data/travel_lists.json`;\n    const res = await fetch(url, { cache: 'no-store' });\n    travelLists = await res.json();\n  } catch {\n    travelLists = {};\n  }\n  renderTravelCities();\n  renderTravelGrid();\n}\n\nfunction renderTravelCities() {\n  const select = byId('travel-city-select');\n  if (!select) return;\n\n  const cities = Object.keys(travelLists);\n  select.innerHTML = cities.map((c) => `<option value=\"${c}\">${c}</option>`).join('');\n\n  select.addEventListener('change', () => renderTravelGrid());\n}\n\nfunction renderTravelGrid() {\n  const city = byId('travel-city-select')?.value || Object.keys(travelLists)[0];\n  const items = (travelLists[city] || []).slice(0, 10);\n  const grid = byId('travel-grid');\n  if (!grid) return;\n\n  grid.innerHTML = '';\n  items.forEach((t) => {\n    const card = document.createElement('div');\n    card.className = 'travel-card';\n    card.innerHTML = `\n      <div class=\"travel-emoji\">${t.emoji}</div>\n      <div class=\"travel-body\">\n        <div class=\"travel-title\">${escapeHtml(t.name)}</div>\n        <div class=\"travel-note\">${escapeHtml(t.note || '')}</div>\n      </div>\n    `;\n    card.addEventListener('click', () => tryTravel(city, t.name));\n    grid.appendChild(card);\n  });\n}\n\nfunction tryTravel(city, itemName) {\n  const moodInput = byId('mood-input');\n  if (moodInput) moodInput.value = `travel mode: try ${itemName} in ${city}`;\n  handleDecision();\n}\n\n// ---------------- Events Near Me ----------------\nasync function loadEvents() {\n  try {\n    const url = API_BASE ? `${API_BASE}/data/events.json` : `/data/events.json`;\n    const res = await fetch(url, { cache: 'no-store' });\n    eventItems = await res.json();\n  } catch {\n    eventItems = [];\n  }\n  renderEvents();\n}\n\nfunction renderEvents() {\n  const grid = byId('events-grid');\n  if (!grid) return;\n\n  grid.innerHTML = '';\n  eventItems.forEach((e) => {\n    const card = document.createElement('div');\n    card.className = 'event-card';\n\n    const badge = document.createElement('div');\n    badge.className = 'event-badge';\n    badge.textContent = e.emoji;\n\n    const body = document.createElement('div');\n    body.className = 'event-body';\n\n    const title = document.createElement('div');\n    title.className = 'event-title';\n    title.textContent = e.title;\n\n    const meta = document.createElement('div');\n    meta.className = 'event-meta';\n    meta.textContent = `${e.date} ‚Ä¢ ${e.area} ‚Ä¢ ${e.price || 'Free'}`;\n\n    const cta = document.createElement('div');\n    cta.className = 'event-cta';\n\n    const detailsBtn = document.createElement('button');\n    detailsBtn.className = 'insights-toggle';\n    detailsBtn.textContent = 'Details';\n    detailsBtn.addEventListener('click', () => goEvent(e.title));\n\n    const mapsBtn = document.createElement('button');\n    mapsBtn.className = 'insights-toggle';\n    mapsBtn.textContent = 'Directions';\n    mapsBtn.addEventListener('click', () => goMaps(encodeURIComponent(e.map || e.title)));\n\n    cta.append(detailsBtn, mapsBtn);\n    body.append(title, meta, cta);\n    card.append(badge, body);\n    grid.appendChild(card);\n  });\n}\n\nfunction goEvent(title) {\n  toast(`üé™ ${title}\\n(Integrate ticket link or detail view here)`, 'info');\n}\nfunction goMaps(q) {\n  window.open(`https://www.google.com/maps/search/?api=1&query=${q}`, '_blank');\n}\n\n// ---------------- Tabs ----------------\nfunction wireTabs() {\n  document.querySelectorAll('.tab-btn').forEach((btn) => {\n    btn.addEventListener('click', () => {\n      document.querySelectorAll('.tab-btn').forEach((b) => b.classList.remove('active'));\n      btn.classList.add('active');\n\n      const toShow = btn.dataset.tab;\n      document.querySelectorAll('.tabpanel').forEach((p) => p.classList.add('hidden'));\n      byId(toShow)?.classList.remove('hidden');\n      currentTab = toShow;\n    });\n  });\n}\n\n// ---------------- Mood ----------------\nfunction detectMood() {\n  const input = byId('mood-input');\n  const val = input?.value?.trim();\n  if (!val) return toast('üß† Please enter your mood first!', 'warn');\n  toast('üß† Mood analyzed ‚Äî using it in your next suggestion!', 'info');\n  handleDecision();\n}\n\n// ---------------- Stats ----------------\nfunction incrementStats({ timeSavedMin = 2 } = {}) {\n  const raw = localStorage.getItem('vfied_stats');\n  const stats = raw ? JSON.parse(raw) : { totalDecisions: 0, timeSaved: 0 };\n  stats.totalDecisions += 1;\n  stats.timeSaved += timeSavedMin;\n  localStorage.setItem('vfied_stats', JSON.stringify(stats));\n  updateStatsUI();\n}\n\nfunction updateStatsUI() {\n  const raw = localStorage.getItem('vfied_stats');\n  const stats = raw ? JSON.parse(raw) : { totalDecisions: 0, timeSaved: 0 };\n  setText('decisions-count', stats.totalDecisions);\n  setText('time-saved', stats.timeSaved);\n}\n\n// ---------------- Skeleton UI ----------------\nfunction showSuggestionSkeleton() {\n  // show the skeleton section and hide the real result container\n  const skel = byId('suggestion-skeleton');\n  const res = byId('suggestion-result');\n  if (skel) skel.classList.remove('hidden');\n  if (res) res.classList.add('hidden');\n}\n\nfunction hideSuggestionSkeleton() {\n  // hide the skeleton; showSuggestion() will reveal the real result\n  const skel = byId('suggestion-skeleton');\n  if (skel) skel.classList.add('hidden');\n}\n\n// ---------------- Toasts ----------------\nfunction mountToastHost() {\n  if (byId('vfied-toast-host')) return;\n  const host = document.createElement('div');\n  host.id = 'vfied-toast-host';\n  document.body.appendChild(host);\n}\nfunction toast(msg, type = 'info') {\n  const host = byId('vfied-toast-host');\n  if (!host) return console.log(msg);\n  const el = document.createElement('div');\n  el.className = `vfied-toast ${type}`;\n  el.textContent = msg;\n  host.appendChild(el);\n  // animate in\n  requestAnimationFrame(() => el.classList.add('show'));\n  // auto remove\n  setTimeout(() => {\n    el.classList.remove('show');\n    setTimeout(() => host.removeChild(el), 250);\n  }, 2600);\n}\n\n// ---------------- Runtime Styles (toasts + skeleton) ----------------\nfunction injectRuntimeStyles() {\n  if (document.getElementById('vfied-runtime-styles')) return;\n  const css = `\n  #vfied-toast-host {\n    position: fixed; left: 50%; bottom: 24px; transform: translateX(-50%);\n    display: flex; flex-direction: column; gap: 8px; z-index: 9999; pointer-events: none;\n  }\n  .vfied-toast {\n    pointer-events: auto;\n    min-width: 240px; max-width: 92vw;\n    padding: 10px 14px; border-radius: 10px; backdrop-filter: blur(8px);\n    background: rgba(0,0,0,.65); color: #fff; font-weight: 600; font-size: 14px;\n    opacity: 0; transform: translateY(8px); transition: all .25s ease;\n    border: 1px solid rgba(255,255,255,.15);\n  }\n  .vfied-toast.show { opacity: 1; transform: translateY(0); }\n  .vfied-toast.success { background: rgba(34,197,94,.85); }\n  .vfied-toast.warn { background: rgba(245,158,11,.9); }\n  .vfied-toast.error { background: rgba(239,68,68,.9); }\n\n  .skeleton-card {\n    background: rgba(255,255,255,.12); border: 1px solid rgba(255,255,255,.18);\n    border-radius: 16px; padding: 18px; max-width: 420px; margin: 8px auto;\n  }\n  .sk-line {\n    height: 14px; margin: 10px 0;\n    background: linear-gradient(90deg, rgba(255,255,255,.15), rgba(255,255,255,.25), rgba(255,255,255,.15));\n    background-size: 200% 100%; animation: sk-shimmer 1.4s infinite;\n    border-radius: 8px;\n  }\n  .sk-emoji { height: 46px; width: 46px; border-radius: 50%; margin: 0 auto 10px; }\n  .sk-title { height: 18px; width: 70%; margin: 12px auto; }\n  .sk-sub { width: 90%; margin: 10px auto; }\n  .sk-sub.short { width: 60%; }\n  @keyframes sk-shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }\n\n  /* Friend avatar chip (if your CSS doesn't already style it) */\n  .friend-chip { display:inline-flex; align-items:center; gap:8px; }\n  .friend-avatar { width:22px; height:22px; border-radius:50%; object-fit:cover; }\n  `;\n  const style = document.createElement('style');\n  style.id = 'vfied-runtime-styles';\n  style.textContent = css;\n  document.head.appendChild(style);\n}\n\n// ---------------- Utils ----------------\nfunction byId(id) {\n  const el = document.getElementById(id);\n  // console.warn on missing but don't spam constantly\n  return el;\n}\nfunction setText(id, text) {\n  const el = byId(id);\n  if (el) el.textContent = text;\n}\nfunction setHTML(id, html) {\n  const el = byId(id);\n  if (el) el.innerHTML = html;\n}\nfunction show(id) {\n  const el = byId(id);\n  if (el) el.classList.remove('hidden');\n}\nfunction hide(id) {\n  const el = byId(id);\n  if (el) el.classList.add('hidden');\n}\nfunction updateContext(msg) {\n  setText('context-info', msg);\n}\nfunction sample(a) {\n  return a[Math.floor(Math.random() * a.length)];\n}\n\nfunction escapeHtml(s) {\n  return String(s).replace(/[&<>\"']/g, (m) => (\n    { '&': '&amp;', '<': '&lt;', '>': '&gt;', '\"': '&quot;', \"'\": '&#039;' }[m]\n  ));\n}\n// User prefs (stub for now)\nfunction getUserPrefs() {\n  try {\n    return JSON.parse(localStorage.getItem('vfied_prefs') || '{}');\n  } catch {\n    return {};\n  }\n}\n\n// Modal helpers\nfunction openModal(m) {\n  if (!m) return;\n  m.setAttribute('aria-hidden', 'false');\n  m.classList.add('open');\n}\nfunction closeModal(m) {\n  if (!m) return;\n  m.setAttribute('aria-hidden', 'true');\n  m.classList.remove('open');\n}\n\n// Expose helpers for inline onclick\nwindow.VFIED = {\n  askFriend,\n  exploreGem,\n  tryTravel,\n  goEvent,\n  goMaps,\n};"],"names":["qpApi","URLSearchParams","location","search","get","localStorage","setItem","storedApi","getItem","runtimeApi","window","__API__","API_BASE","replace","console","log","demoFriends","name","comment","emoji","avatar","fallbackSuggestions","food","friendMessage","availabilityNote","culturalNote","weatherNote","source","localGems","travelLists","eventItems","setThinking","btn","on","el","document","getElementById","disabled","icon","text","textContent","e","warn","async","handleDecision","decideBtn","byId","skel","res","classList","remove","add","showSuggestionSkeleton","updateContext","mood","value","trim","prefs","JSON","parse","getUserPrefs","payload","city","country","country_code","mood_text","dietary","budget","menu_source","url","fetch","method","headers","body","stringify","ok","Error","status","statusText","s","json","showSuggestion","addSocialSignals","timeSavedMin","raw","stats","totalDecisions","timeSaved","updateStatsUI","incrementStats","err","error","a","Math","floor","random","length","toast","hideSuggestionSkeleton","id","show","setText","reasoning","setHTML","personalNote","slot","html","socialSignal","message","localSignal","innerHTML","renderSocialSignals","handleAccept","hide","handleTryAgain","askFriend","f","find","x","moodInput","suggestion","foodName","toLowerCase","friend","includes","type","g","list","area","exploreGem","renderTravelGrid","Object","keys","items","slice","grid","forEach","t","card","createElement","className","escapeHtml","note","addEventListener","tryTravel","appendChild","itemName","goEvent","title","goMaps","q","open","detectMood","input","val","msg","host","requestAnimationFrame","setTimeout","removeChild","String","m","closeModal","setAttribute","css","style","head","injectRuntimeStyles","mountToastHost","detectBtn","acceptBtn","tryAgainBtn","insightsToggle","content","contains","seeMoreBtn","modal","closeBtn","map","join","populateGemsModal","target","wireCoreEvents","querySelectorAll","b","toShow","dataset","tab","p","container","renderFriendChips","cache","first","renderLocalGemsGrid","loadLocalGems","select","cities","c","renderTravelCities","loadTravelLists","badge","meta","date","price","cta","detailsBtn","mapsBtn","encodeURIComponent","append","renderEvents","loadEvents","VFIED"],"mappings":"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"}